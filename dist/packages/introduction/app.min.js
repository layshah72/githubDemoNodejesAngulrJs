'use strict';


var introductionModule = angular.module('introductionModule', ['ngRoute', 'ngResource',
		'sharedModule']);
/**
 * Copyright (C) 2015, layshah
 * 
 * Description : Shared Util - appUtil: Shared utility functions for the
 * application.
 * 
 * @author lay shah
 */
introductionModule.controller('introductionPageController', ['$rootScope','$scope','introductionService','indexService','$location', function($rootScope,$scope,introductionService,indexService,$location){
    
   

window.scrollTo(0,0); 
$rootScope.showNavbarDetail=false;
$rootScope.showStepBar=false;
$rootScope.signUpLink="#/introduction";
$rootScope.signUpValue="Sign Up";
$rootScope.signUpModal="#signUpModal";
$rootScope.isDisabedIP=true;
    $scope.child=function(){
        if($scope.married=="Married"){
            $scope.childQue=true;
           
        }
        else{
            $scope.childQue=false;  
            
        }
    }
    
    $scope.saveIntroduction=function(){
        if($scope.child=="Yes"){
            $scope.child=1;
        }
        else{
            $scope.child=0;
        }

        if($scope.married=="Married"){
           
            $scope.married=1;
        }
        else{
           
            $scope.married=0; 
        }
        if($scope.married!=null && $scope.name!=null && $scope.age!=null){
        var promiseEnterUserDetails = introductionService.addIntro($scope.name,parseInt($scope.age),parseInt($scope.income),$scope.married,'male',$scope.child);
                promiseEnterUserDetails.$promise.then(function(data) {
                    console.log(data.category);
                    $location.path('goalSetting');
                    
                     indexService.saveCategory(data.category);
                    location.reload(true);
                 }, function(reason) {
                    $scope.message = reason;
                });
        }        
        
    }

    
    
}]);
'use strict';

/**
 * Copyright (C) 2015, layshah
 * 
 * Description : Shared Util - appUtil: Shared utility functions for the
 * application.
 * 
 * @author lay shah
 */

/**
 * Create categoryResource factory
 * 
 * @param $resource
 * 
 * @return categoryResource
 */
introductionModule.factory('introductionResource', [ '$resource', function($resource) {
	var introductionResource = $resource('/api/intoduction/createIntro', {}, {
		// Get all eventValueTypes
		

		createIntro : {
			method : 'POST',
			url : '/api/intoduction/createIntro'
		}
	});

	return introductionResource;
} ]);


introductionModule.config([ '$routeProvider', function($routeProvider) {

	$routeProvider.when('/introduction', {
		templateUrl : 'rootFunvestApp/introduction/public/views/introduction.ejs',
		controller : 'loginController'
	});


}]);


introductionModule.run([ '$location', '$rootScope', function($location, $rootScope) {
	$rootScope.activePath = null;
	$rootScope.$on('$routeChangeSuccess', function(event, current, previous) {
		$rootScope.title = current.$$route.title;
		$rootScope.activePath = $location.path();
	});
}]);
introductionModule.factory('introductionService', ['introductionResource','$q',function(introductionResource,$q) {
			
	return{
				
		addIntro: function(name,age,income,marrtialStatus,gender,child){
			var introParam={
		 		maritial_status: marrtialStatus,
		 		have_children:child,
		 		age:age,
		 		gender:gender,
		 		annual_income:income

		 	};
		 	return introductionResource.createIntro(introParam);
		 		
		}
		
	}
} 
]);
